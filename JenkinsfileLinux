pipeline {
    agent { label 'cking168' }
    // tools { maven 'M3' }
    options {
        disableConcurrentBuilds()
        buildDiscarder(logRotator(numToKeepStr: '5'))
    }
    environment {
        build_desc = showBuildDesc()
    }
    stages {
        stage('Init') {
            steps {
              checkout scm
              sh 'echo THIS IS ${env.build_desc}'
            }
        }
        stage('Build') {
            steps {
                sh 'mvn clean package'
            }
        }
        stage('Docker Image') {
            steps {
                script {
                    def dockerImage = docker.build("my-app:latest")
                }
            }
        }
    }
}
